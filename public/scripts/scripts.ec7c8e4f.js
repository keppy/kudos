"use strict";angular.module("kudosApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl"}).when("/dashboard",{templateUrl:"views/dashboard.html",controller:"DashboardCtrl"}).otherwise({redirectTo:"/"})}]).constant("AUTH_EVENTS",{loginSuccess:"auth-login-success",loginFailed:"auth-login-failed",logoutSuccess:"auth-logout-success",notAuthenticated:"auth-not-authenticated"}).constant("BASE_API_URL","http://localhost:3000").run(["$rootScope","AUTH_EVENTS","AuthService",function(a,b,c){a.$on("$routeChangeStart",function(d){c.isAuthenticated()||(d.preventDefault(),a.$broadcast(b.notAuthenticated))})}]),angular.module("kudosApp").controller("MainCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("kudosApp").controller("AboutCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("kudosApp").controller("LoginCtrl",["$scope","$rootScope","AUTH_EVENTS","AuthService","$location","Session",function(a,b,c,d,e,f){a.credentials={person:{email:"",password:""}},a.login=function(a){d.login(a).then(function(a){b.$broadcast(c.loginSuccess),f.create(a.id),e.path("/dashboard")},function(){b.$broadcast(c.loginFailed)})}}]),angular.module("kudosApp").factory("AuthService",["$http","Session","BASE_API_URL",function(a,b,c){var d={};return d.login=function(d){return a.post(c+"/create",d).then(function(a){return b.create(a.data.id),a.data})},d.isAuthenticated=function(){return!!b.id},d}]),angular.module("kudosApp").service("Session",["$cookieStore",function(a){this.create=function(b){a.put("id",b),this.id=b},this.destroy=function(){a.put("id",""),this.id=null},this.get=function(){a.get("id")}}]),angular.module("kudosApp").controller("ApplicationCtrl",["$scope","$rootScope",function(a,b){a.setCurrentUser=function(a){b.currentUser=a}}]),angular.module("kudosApp").controller("DashboardCtrl",["$scope","Person","Session","$cookieStore","Kudos","$location",function(a,b,c,d,e,f){var g=b.me(d.get("id")),h=e.index(d.get("id")),i=b.index(d.get("id"));a.kudo={kudo:{sender_id:null,reciever_id:null,content:null}},a.selectedPerson=null,a.blankKudo=angular.copy(a.kudo),a.createKudo=function(){a.kudo.kudo.sender_id=a.currentUser.id,a.kudo.kudo.reciever_id=a.selectedPerson.id;var b=e.create(a.kudo);b.then(function(){--a.currentUser.kudos_available,a.kudo=angular.copy(a.blankKudo)})},g.then(function(b){a.currentUser=b}),h.then(function(b){a.kudos=b}),i.then(function(b){a.people=b}),a.logOut=function(){c.destroy(),f.path("/")}}]),angular.module("kudosApp").factory("Person",["BASE_API_URL","$http",function(a,b){var c={};return c.me=function(c){return b.get(a+"/me/"+c).then(function(a){return a.data})},c.index=function(c){return b.get(a+"/people/"+c).then(function(a){return a.data})},c}]),angular.module("kudosApp").factory("Kudos",["$http","BASE_API_URL",function(a,b){var c={};return c.index=function(c){return a.get(b+"/kudos/"+c).then(function(a){return a.data})},c.create=function(c){return a.post(b+"/kudos",c).then(function(a){return a.data})},c}]);